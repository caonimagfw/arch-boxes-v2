# mke2fs.conf â€” CloudCone-compatible ext4 defaults.
#
# Purpose: CloudCone host GRUB (2.02-81.el8) does NOT support modern ext4
#          features: 64bit, metadata_csum, metadata_csum_seed, orphan_file.
#          This config produces an ext4 filesystem with EXACTLY the same
#          features as CloudCone's official Debian 11 images, guaranteeing
#          full GRUB 2.02 compatibility.
#
# Reference: CloudCone Debian 11 filesystem features (tune2fs -l /dev/vda1):
#   has_journal ext_attr resize_inode dir_index filetype extent flex_bg
#   sparse_super large_file huge_file uninit_bg dir_nlink extra_isize
#
# Features explicitly EXCLUDED (not in Debian 11 either):
#   - metadata_csum  (GRUB 2.02 can't parse checksummed metadata)
#   - 64bit          (GRUB 2.02 can't handle 64-bit block addressing)
#   - orphan_file    (e2fsprogs >=1.47, GRUB 2.02 unknown)
#
# IMPORTANT: This config is used by Debian 11's mkfs.ext4 (e2fsprogs 1.46.2)
#            in the GitHub Actions workflow to ensure byte-identical on-disk
#            format with CloudCone's official images.
#
# Usage:   MKE2FS_CONFIG=debian11-mke2fs.conf mkfs.ext4 -F /dev/loopXp1

[defaults]
	base_features = sparse_super,large_file,filetype,resize_inode,dir_index,ext_attr
	default_mntopts = acl,user_xattr
	enable_periodic_fsck = 0
	blocksize = 4096
	inode_size = 256
	inode_ratio = 16384

[fs_types]
	ext3 = {
		features = has_journal
	}
	ext4 = {
		features = has_journal,extent,huge_file,flex_bg,uninit_bg,dir_nlink,extra_isize
		inode_size = 256
	}
	ext4dev = {
		features = has_journal,extent,huge_file,flex_bg,uninit_bg,dir_nlink,extra_isize
		inode_size = 256
	}
	small = {
		blocksize = 1024
		inode_size = 128
		inode_ratio = 4096
	}
	floppy = {
		blocksize = 1024
		inode_size = 128
		inode_ratio = 8192
	}
	big = {
		inode_ratio = 32768
	}
	huge = {
		inode_ratio = 65536
	}
	news = {
		inode_ratio = 4096
	}
	largefile = {
		inode_ratio = 1048576
	}
	largefile4 = {
		inode_ratio = 4194304
	}
	hurd = {
		blocksize = 4096
		inode_size = 128
	}
