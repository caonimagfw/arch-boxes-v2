# mke2fs.conf â€” CloudCone-compatible ext4 defaults.
#
# Purpose: Produce an ext4 filesystem identical to CloudCone's official
#          Debian 11 images, guaranteeing full GRUB 2.02-81.el8 compatibility.
#
#          Used together with e2fsprogs 1.46.2 (same version as Debian 11)
#          to ensure both the feature flags AND the on-disk superblock format
#          match exactly what CloudCone's host GRUB can read.
#
#          Features explicitly EXCLUDED (not supported by GRUB 2.02):
#            - metadata_csum  (GRUB 2.02 can't parse checksummed metadata)
#            - 64bit          (GRUB 2.02 can't handle 64-bit block addressing)
#
#          Verified working features (from CloudCone Debian 11):
#            has_journal ext_attr resize_inode dir_index filetype extent
#            flex_bg sparse_super large_file huge_file uninit_bg dir_nlink
#            extra_isize
#
# Usage:   MKE2FS_CONFIG=debian11-mke2fs.conf /opt/e2fs-compat/sbin/mkfs.ext4 -F /dev/loopX

[defaults]
	base_features = sparse_super,large_file,filetype,resize_inode,dir_index,ext_attr
	default_mntopts = acl,user_xattr
	enable_periodic_fsck = 0
	blocksize = 4096
	inode_size = 256
	inode_ratio = 16384

[fs_types]
	ext3 = {
		features = has_journal
	}
	ext4 = {
		features = has_journal,extent,huge_file,flex_bg,uninit_bg,dir_nlink,extra_isize
		inode_size = 256
	}
	ext4dev = {
		features = has_journal,extent,huge_file,flex_bg,uninit_bg,dir_nlink,extra_isize
		inode_size = 256
	}
	small = {
		blocksize = 1024
		inode_size = 128
		inode_ratio = 4096
	}
	floppy = {
		blocksize = 1024
		inode_size = 128
		inode_ratio = 8192
	}
	big = {
		inode_ratio = 32768
	}
	huge = {
		inode_ratio = 65536
	}
	news = {
		inode_ratio = 4096
	}
	largefile = {
		inode_ratio = 1048576
	}
	largefile4 = {
		inode_ratio = 4194304
	}
	hurd = {
		blocksize = 4096
		inode_size = 128
	}
