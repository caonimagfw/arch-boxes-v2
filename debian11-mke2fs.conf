# mke2fs.conf â€” CloudCone-compatible ext4 defaults.
#
# Purpose: CloudCone host GRUB (2.02-81.el8) does NOT support modern ext4
#          features: 64bit, metadata_csum, metadata_csum_seed, orphan_file.
#          By using MKE2FS_CONFIG to override the build host's mke2fs.conf,
#          we produce an ext4 filesystem identical to CloudCone's official
#          Debian images, guaranteeing full GRUB compatibility.
#
#          Features explicitly EXCLUDED vs Debian 11 defaults:
#            - metadata_csum  (GRUB 2.02 can't parse checksummed metadata)
#            - 64bit          (GRUB 2.02 can't handle 64-bit block addressing)
#            - dir_index      (GRUB 2.02 can't traverse htree directory hashes
#                              created by newer e2fsprogs; use linear dirs instead)
#
# Usage:   MKE2FS_CONFIG=debian11-mke2fs.conf mkfs.ext4 -F /dev/loopXp1

[defaults]
	base_features = sparse_super,large_file,filetype,resize_inode,ext_attr
	default_mntopts = acl,user_xattr
	enable_periodic_fsck = 0
	blocksize = 4096
	inode_size = 256
	inode_ratio = 16384

[fs_types]
	ext3 = {
		features = has_journal
	}
	ext4 = {
		features = has_journal,extent,huge_file,flex_bg,uninit_bg,dir_nlink,extra_isize
		inode_size = 256
	}
	ext4dev = {
		features = has_journal,extent,huge_file,flex_bg,uninit_bg,dir_nlink,extra_isize
		inode_size = 256
	}
	small = {
		blocksize = 1024
		inode_size = 128
		inode_ratio = 4096
	}
	floppy = {
		blocksize = 1024
		inode_size = 128
		inode_ratio = 8192
	}
	big = {
		inode_ratio = 32768
	}
	huge = {
		inode_ratio = 65536
	}
	news = {
		inode_ratio = 4096
	}
	largefile = {
		inode_ratio = 1048576
	}
	largefile4 = {
		inode_ratio = 4194304
	}
	hurd = {
		blocksize = 4096
		inode_size = 128
	}
